<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Mancala</title>

</head>
<body>
    <h1 class="Title">Mancala </h1>
  </p> Enjoy the game! </p>
  <p role="image" aria-label="happy sun">ðŸŒž</p>
  
  <style> 
  #header {
	grid-row: 1/2;
	grid-column: 1/-1;
	justify-self: center;
	font-size: 25px;
}

.board {
	display: grid;
	grid-template-rows: 3;
	grid-template-columns: repeat(3, 200px);
	grid-gap: 20px;
	justify-content: center;
}

.goal {
	grid-row: 2/4;
	&__one {
		grid-column: -2/-1;
		grid-row: 2/4;
	}
	&__two {
		grid-column: 1/2;
		grid-row: 2/4;
	}
}
.playerOneRow {
	grid-row: 3/4;
	grid-column: 2/-2;
	grid-template-columns: repeat(6, 1fr);
}
.playerTwoRow {
	grid-row: 2/3;
	grid-column: 2/-2;
	grid-template-columns: repeat(6, 1fr);
}

button {
		font-size: 25px;
}
  </style>

<script>
const playerOneRow = [
	{ name: "goalTwo", marbles: 0 },
	{ name: "spotZero", marbles: 4 },
	{ name: "spotOne", marbles: 4 },
	{ name: "spotTwo", marbles: 4 },
	{ name: "spotThree", marbles: 4 },
	{ name: "spotFour", marbles: 4 },
	{ name: "spotFive", marbles: 4 }
];

const playerTwoRow = [
	{ name: "goalTwo", marbles: 0 },
	{ name: "spotZero", marbles: 4 },
	{ name: "spotOne", marbles: 4 },
	{ name: "spotTwo", marbles: 4 },
	{ name: "spotThree", marbles: 4 },
	{ name: "spotFour", marbles: 4 },
	{ name: "spotFive", marbles: 4 }
];

// const playerOneRow = [
// 	{ name: "goalTwo", marbles: 0 },
// 	{ name: "spotZero", marbles: 5 },
// 	{ name: "spotOne", marbles: 0 },
// 	{ name: "spotTwo", marbles: 0 },
// 	{ name: "spotThree", marbles: 0 },
// 	{ name: "spotFour", marbles: 0 },
// 	{ name: "spotFive", marbles: 0 }
// ]; // ALL 0 TEST

var playerOne = true;
var playerTwo = false;

turnSwitch = () => {
	playerOne = !playerOne;
	playerTwo = !playerTwo;
}
updateHeader = () => {
	let player;
	switch(playerOne) {
	case true:
		player = "Player 1";
		break;
	case false:
		player = "Player 2";
		break;
	}
	document.getElementById("header").innerHTML = `It is ${player}'s turn`
}
playerMove = (player, spot) => {
	let playerCheck = player;
	if((playerCheck === "p1" && playerOne) || (playerCheck === "p2" && playerTwo) ) {
		if (playerOne) {
			playerRow = playerOneRow;
		} else {
			playerRow = playerTwoRow;
		}
		if (playerRow[spot].marbles !== 0) {
			s = 1;
			sExtend = 0;
			superExtend = 1;
			ultraExtend = 0;
			reflow = 0;
			for (i = 0; i < playerRow[spot].marbles; i++) {
				// setInterval(() => {
				if (s <= 7 - (spot + 1)) {
					playerRow[spot + s].marbles++;
				} else if (s > 7 - (spot + 1) && s <= 7 - (spot + 1) + 7) {
					if (playerOne) {
						playerTwoRow[sExtend].marbles++;
						sExtend++;
					} else if (playerTwo) {
						playerOneRow[sExtend].marbles++;
						sExtend++;
					}
				} else if (s > 7 - (spot + 1) + 7 && s < 7 - (spot + 1) + 14) {
					if (playerOne) {
						playerOneRow[superExtend].marbles++;
						superExtend++;
						reflow = 1;
					} else if (playerTwo) {
						playerTwoRow[superExtend].marbles++;
						superExtend++;
						reflow = 1;
					}
				} else if (s > 7 - (spot + 1) + 14 && s <= 7 - (spot + 1) + 21) {
					if (playerOne) {
						playerTwoRow[ultraExtend].marbles++;
						ultraExtend++;
					} else if (playerTwo) {
						playerOneRow[ultraExtend].marbles++;
						ultraExtend++;
					}
				} else {
					console.log("too many .(-.-).");
				}
				s++;
		// }, );
			}
			playerRow[spot].marbles = reflow;
			endCheck();
			turnSwitch();
			updateDisplay();
		} else {
			console.log("Pick a spot with marbles");
		}
	} else {
		/*make players choose again*/
		console.log("NOT YOUR TURN CHEATER!");
	}
};

updateDisplay = () => {
	updateHeader();
	document.getElementById("p2goal").innerHTML = playerOneRow[0].marbles;
	document.getElementById("p1spot1").innerHTML = playerOneRow[1].marbles;
	document.getElementById("p1spot2").innerHTML = playerOneRow[2].marbles;
	document.getElementById("p1spot3").innerHTML = playerOneRow[3].marbles;
	document.getElementById("p1spot4").innerHTML = playerOneRow[4].marbles;
	document.getElementById("p1spot5").innerHTML = playerOneRow[5].marbles;
	document.getElementById("p1spot6").innerHTML = playerOneRow[6].marbles;
	document.getElementById("p1goal").innerHTML = playerTwoRow[0].marbles;
	document.getElementById("p2spot1").innerHTML = playerTwoRow[1].marbles;
	document.getElementById("p2spot2").innerHTML = playerTwoRow[2].marbles;
	document.getElementById("p2spot3").innerHTML = playerTwoRow[3].marbles;
	document.getElementById("p2spot4").innerHTML = playerTwoRow[4].marbles;
	document.getElementById("p2spot5").innerHTML = playerTwoRow[5].marbles;
	document.getElementById("p2spot6").innerHTML = playerTwoRow[6].marbles;
};

endCheck = () => {
	let one = playerOneRow;
	let two = playerTwoRow;
	let marbles1 = one.map(a => a.marbles).splice(1);
	let marbles2 = two.map(a => a.marbles).splice(1);
	let empty = [0, 0, 0, 0, 0, 0]
	if (arrayCompare(marbles1, empty)) {
		sweepRow(one, marbles2);
		updateDisplay();
	} else if (arrayCompare(marbles2, empty)) {
		sweepRow(two, marbles1);
		updateDisplay();
	}
}

arrayCompare = (array1, array2) => {
	let arr1 = array1.join()
	let arr2 = array2.join()
	return(arr1 === arr2)
	console.log(arr1, arr2)
}

sweepRow = (playerRow, arrayToSweep) => {
	if(playerRow == playerOneRow) {
		playerOtherRow = playerTwoRow;
	} else {
		playerOtherRow = playerOneRow;
	}
	let total1 = arrayToSweep.reduce((total, num) => {return total+num})
	let total2 = playerOtherRow[0].marbles
	playerOtherRow.forEach(item => item.marbles = 0);
	playerRow[0].marbles = total1;
	playerOtherRow[0].marbles = total2;
	updateDisplay();
	gameEnd();
}

gameEnd = () => {
	let goalOne = playerTwoRow[0].marbles
	let goalTwo = playerOneRow[0].marbles
	if(goalOne > goalTwo) {
		console.log("Player 1 wins!!!")
	} else if(goalTwo > goalOne) {
		console.log("Player 2 wins!!!")
	} else {
		console.log("IT'S A TIE!!!")
	}
}

getNewTotal = (total, num) => {
	return total+num;
}

updateDisplay();

</script>

<div class="board">
<div id="header"></div>
	<button id="p2goal" class="goal__two"></button>
	<div class="playerOneSpot">
		<button id="p1spot1" onClick="playerMove('p1', 1)"></button>
		<button id="p1spot2" onClick="playerMove('p1', 2)"></button>
		<button id="p1spot3" onClick="playerMove('p1', 3)"></button>
		<button id="p1spot4" onClick="playerMove('p1', 4)"></button>
		<button id="p1spot5" onClick="playerMove('p1', 5)"></button>
		<button id="p1spot6" onClick="playerMove('p1', 6)"></button>
	</div>
	<div class="playerTwoRow">
		<button id="p2spot6" onClick="playerMove('p2', 6)"></button>
		<button id="p2spot5" onClick="playerMove('p2', 5)"></button>
		<button id="p2spot4" onClick="playerMove('p2', 4)"></button>
		<button id="p2spot3" onClick="playerMove('p2', 3)"></button>
		<button id="p2spot2" onClick="playerMove('p2', 2)"></button>
		<button id="p2spot1" onClick="playerMove('p2', 1)"></button>
	</div>

	<button id="p1goal" class="goal__one"></button>
</div>






</body>
</html> 
